import streamlit as st
import pandas as pd
import plotly.express as px

# 데이터 로드
file_path_1 = '/mnt/data/202504_202504_연령별인구현황_월간 (1).csv'
data_1 = pd.read_csv(file_path_1, encoding='ISO-8859-1')

# 컬럼명 변경
data_1.columns = [
    '지역', '2025년04월_연령별_인구', '2025년04월_연령별_합계', '2025년04월_0~9', '2025년04월_10~19', 
    '2025년04월_20~29', '2025년04월_30~39', '2025년04월_40~49', '2025년04월_50~59', 
    '2025년04월_60~69', '2025년04월_70~79', '2025년04월_80~89', '2025년04월_90~99', 
    '2025년04월_100이상', '2025년04월_여성_연령별_인구', '2025년04월_여성_연령별_합계', '2025년04월_여성_0~9', 
    '2025년04월_여성_10~19', '2025년04월_여성_20~29', '2025년04월_여성_30~39', '2025년04월_여성_40~49', 
    '2025년04월_여성_50~59', '2025년04월_여성_60~69', '2025년04월_여성_70~79', '2025년04월_여성_80~89', 
    '2025년04월_여성_90~99', '2025년04월_여성_100이상'
]

# 필요한 컬럼만 추출하여 시각화
data_1_filtered = data_1[['지역', '2025년04월_0~9', '2025년04월_10~19', '2025년04월_20~29', 
                           '2025년04월_30~39', '2025년04월_40~49', '2025년04월_50~59', 
                           '2025년04월_60~69', '2025년04월_70~79', '2025년04월_80~89']]

# 숫자 데이터로 변환
data_1_filtered = data_1_filtered.apply(pd.to_numeric, errors='coerce')

# Plotly로 연령대별 인구 분포 시각화
fig = px.bar(data_1_filtered, 
             x='지역', 
             y=['2025년04월_0~9', '2025년04월_10~19', '2025년04월_20~29', 
                 '2025년04월_30~39', '2025년04월_40~49', '2025년04월_50~59', 
                 '2025년04월_60~69', '2025년04월_70~79', '2025년04월_80~89'], 
             title="연령대별 인구 분포",
             labels={'value': '인구수', 'variable': '연령대'},
             barmode='stack')

# 그래프 출력
st.plotly_chart(fig)
